<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>15th Finance Commission</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
   
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <div class="logo">
          <img src="./ap-logo.jpeg" alt="AP Logo" width="50" height="40">
        </div>
        <div>
          <div class="title">15th Finance Commission</div>
          <div class="subtitle">Government of Andhra Pradesh</div>
        </div>
      </div>
      <div class="row">
        <div id="userBadge" class="badge hidden"></div>
        <button id="adminLogoutBtn" class="btn secondary hidden" style="margin-left: 12px;">Logout</button>
      </div>
    </div>

    <div id="loginPanel" class="panel login-wrap">
      <div class="stack">
        <div class="center" style="margin-bottom:4px; font-weight:600; font-size:18px;">Sign in</div>
        <div id="loginError" class="banner error hidden">Invalid credentials. Try admin / admin123.</div>
        <div class="field">
          <label>Username</label>
          <input id="username" type="text" placeholder="Enter username" autocomplete="username" />
        </div>
        <div class="field">
          <label>Password</label>
          <input id="password" type="password" placeholder="Enter password" autocomplete="current-password" />
        </div>
        <div class="row" style="justify-content: flex-end;">
          <button id="loginBtn" class="btn">Login</button>
        </div>
      </div>
    </div>

    <div id="dashboard" class="stack hidden">
      <div class="panel">
        <div class="row" style="justify-content: space-between; align-items: center; margin-bottom: 8px;">
          <div class="section-title">Filters</div>
          <div id="selectionChips" class="row"></div>
        </div>
        <div class="grid">
          <div class="field">
            <label>Year</label>
            <select id="year">
              <option value="" selected>Select year</option>
              <option>2021-22</option>
              <option>2022-23</option>
              <option>2023-24</option>
              <option>2024-25</option>
              <option>2025-26</option>
            </select>
          </div>
          <div class="field">
            <label>Installment</label>
            <select id="installment" disabled>
              <option value="" selected>Select installment</option>
              <option>First Installment</option>
              <option>Second Installment</option>
            </select>
          </div>
          <div class="field">
            <label>Grant Type</label>
            <select id="grantType" disabled>
              <option value="" selected>Select grant type</option>
              <option>Untied Grant</option>
              <option>Tied Grant</option>
            </select>
          </div>
          <div class="field">
            <label>Program</label>
            <select id="program" disabled>
              <option value="" selected>Select program</option>
              <option>ADP</option>
              <option>RADP</option>
            </select>
          </div>
        </div>
      </div>

      <div id="summaryPanel" class="panel hidden">
        <div class="row" style="justify-content: space-between; align-items: center;">
          <div class="row" id="summaryChips" style="gap:8px; flex-wrap: wrap;"></div>
          <div class="row" style="gap:10px; align-items:baseline;">
            <div class="section-title">Budget</div>
          <div id="budgetAmt" class="budget">₹10,00,000</div>
          <div class="section-title" style="margin-left:12px;">Remaining</div>
          <div id="remainingAmt" class="budget" style="color:#e10d0d;">₹10,00,000</div>
          </div>
        </div>
      </div>

      <div id="radpFormPanel" class="panel hidden">
        <div class="stack">
          <div class="section-title"><span id="programTitle">RADP</span> Details</div>
          <div class="grid">
            <div class="field">
              <label>CR Status</label>
              <div class="row">
                <label class="row" style="gap:6px;"><input type="radio" name="crStatus" id="crStatusCR" value="CR" /> <span>CR</span></label>
                <label class="row" style="gap:6px;"><input type="radio" name="crStatus" id="crStatusIA" value="In Anticipation" /> <span>In anticipation</span></label>
              </div>
            </div>
            <div id="crNumberField" class="field hidden">
              <label>CR Number</label>
              <input id="crNumber" type="text" placeholder="Enter CR number" />
            </div>
            <div id="crDateField" class="field hidden">
              <label>CR Date</label>
              <input id="crDate" type="date" />
            </div>
            <div id="numberOfWorksField" class="field hidden">
              <label>Number of Works</label>
              <input id="numberOfWorks" type="number" inputmode="numeric" min="1" step="1" placeholder="Enter number of works (e.g., 4)" />
            </div>
            <div class="field">
              <label>Name of the Sector</label>
              <select id="workType">
                <option value="" selected>Select type of work</option>
                <option>SWM/LQM</option>
                <option>Water Supply</option>
                <option>UGD Drains</option>
                <option>CC Drains</option>
                <option>CC Roads</option>
                <option>BT Roads</option>
                <option>Construction of Slaughter Houses</option>
                <option>Development of Parks</option>
                <option>Protection of Open Spaces</option>
                <option>Burial grounds & Crematoriums</option>
                <option>Repairs to Municipal Schools</option>
                <option>Urban Health Clinics</option>
                <option>Greenery</option>
                <option>Street Lighting</option>
                <option>CC Charges</option>
                <option>EESL Dues</option>
                <option>ABC & ARV Activities</option>
                <option>Solar Panels</option>
                <option>CB</option>
                <option>IEC</option>
              </select>
            </div>
            <div class="field">
              <label>Name of the Proposals</label>
              <input id="proposalName" type="text" placeholder="Enter proposal name" />
            </div>
            <div class="field">
              <label>Locality</label>
              <textarea id="location" placeholder="Enter locality details"></textarea>
            </div>
            <div class="field">
              <label>Latitude, Longitude or Google Maps URL</label>
              <textarea id="latlong" placeholder="e.g., 16.5062, 80.6480 or https://maps.google.com/... "></textarea>
            </div>
            <div class="field">
              <label>Estimated Cost</label>
              <input id="estimatedCost" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Enter estimated cost" />
            </div>
            <div class="field">
              <label>Prioritization</label>
              <input id="prioritization" type="number" inputmode="numeric" min="1" step="1" placeholder="Enter priority number" />
            </div>
            <div class="field">
              <label>Upload  work Image</label>
              <input id="image" type="file" accept="image/*" />
            </div>
            <div id="crCopyField" class="field hidden">
              <label>Detailed Estimation Report</label>
              <input id="crCopy" type="file" accept=".pdf,image/*" />
            </div>
          </div>
          <div id="formError" class="banner error hidden"></div>
          <div class="footer">
            <button id="submitBtn" class="btn">Submit</button>
          </div>
          <div id="successMsg" class="banner hidden">Submitted successfully.</div>
        </div>
      </div>
      <div id="postSubmitPanel" class="panel hidden">
        <div class="stack">
          <div class="section-title">Signatures and Submission</div>
          <div class="grid">
            <div class="field">
              <label>Committee Report</label>
              <input id="committeeSignature" type="file" accept="image/*,.pdf" />
            </div>
            <div class="field">
              <label>Council Resolution Report</label>
              <input id="councilResolutionSignature" type="file" accept="image/*,.pdf" />
            </div>
          </div>
          <div class="field">
            <label>Submitted Proposals</label>
            <div style="overflow:auto;">
              <table id="submissionTable" style="width:100%; border-collapse:collapse;">
                <thead>
                  <tr>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">S.No</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Name of sector</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Name of proposals</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Estimated cost in Rupees</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Locality</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Prioritization number</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Work Image</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Detailed Report</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Actions</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Status</th>
                    <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Remarks</th>
                  </tr>
                </thead>
                <tbody id="submissionTableBody"></tbody>
              </table>
            </div>
          </div>
          <div class="footer">
            <button id="forwardCommissionerBtn" class="btn secondary">Forward to Commissioner</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Commissioner Dashboard -->
    <div id="commissionerDashboard" class="stack hidden">
      <div class="panel">
        <div class="row" style="justify-content: space-between; align-items: center; margin-bottom: 16px;">
          <div class="section-title">Commissioner Dashboard</div>
          <button id="logoutBtn" class="btn secondary">Logout</button>
        </div>
        <div id="approveSuccessBanner" class="banner hidden" style="margin-bottom:12px;">Work approved successfully.</div>
        <div id="rejectSuccessBanner" class="banner hidden" style="margin-bottom:12px; background:#fee2e2; border-color:#fca5a5; color:#991b1b;">Work rejected and sent back to admin.</div>
        <!-- Post-approval forward panel: appears after an item is approved -->
        <div id="postApprovePanel" class="panel hidden" style="margin-bottom:12px;">
          <div class="section-title">Forward Approved Work to Department</div>
          <div class="grid" style="margin-top:12px;">
            <div class="field">
              <label>Department</label>
              <select id="deptSelect">
                <option value="" selected>Select department</option>
                <option>Public Works</option>
                <option>Urban Development</option>
                <option>Health</option>
                <option>Education</option>
              </select>
            </div>
            <div class="field">
              <label>Section</label>
              <select id="sectionSelect" disabled>
                <option value="" selected>Select section</option>
              </select>
            </div>
            <div class="field" style="grid-column: 1 / -1;">
              <label>Remarks</label>
              <textarea id="forwardRemarks" placeholder="Enter remarks for forwarding..." style="min-height:80px;"></textarea>
            </div>
          </div>
          <div class="footer" style="margin-top:12px;">
            <button id="forwardToDeptBtn" class="btn secondary" disabled>Forward</button>
          </div>
          <div id="forwardSuccess" class="banner hidden" style="margin-top:12px;">Forwarded to department.</div>
        </div>
        <!-- <div class="field">
          <label>Submitted Works for Review</label>
          <div style="overflow:auto;">
            <table id="commissionerTable" style="width:100%; border-collapse:collapse;">
              <thead>
                <tr>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">S.No</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Sector</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Proposal</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Cost</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Locality</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Priority</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Number</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Date</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Status</th>
                  <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Actions</th>
                </tr>
              </thead>
              <tbody id="commissionerTableBody"></tbody>
            </table>
          </div>

          
        </div> -->
<div class="field">
  <label>Submitted Works for Review</label>
  <div style="overflow:auto;">
    <table id="commissionerTable" style="width:100%; border-collapse:collapse;">
      <thead>
        <tr>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">S.No</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Sector</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Proposal</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Cost</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Locality</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Priority</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Number</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Date</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Status</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Actions</th>
        </tr>
      </thead>
      <tbody id="commissionerTableBody"></tbody>
    </table>
  </div>
</div>

<!-- ✅ Approved Works Table -->
<div class="field" style="margin-top: 40px;">
  <label>Approved Works</label>
  <div style="overflow:auto;">
    <table id="approvedTable" style="width:100%; border-collapse:collapse;">
      <thead>
        <tr>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">S.No</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Sector</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Proposal</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Cost</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Locality</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Priority</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Number</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Date</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Status</th>
        </tr>
      </thead>
      <tbody id="approvedTableBody"></tbody>
    </table>
  </div>
</div>

<!-- ✅ Rejected Works Table -->
<div class="field" style="margin-top: 40px;">
  <label>Rejected Works</label>
  <div style="overflow:auto;">
    <table id="rejectedTable" style="width:100%; border-collapse:collapse;">
      <thead>
        <tr>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">S.No</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Sector</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Proposal</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Cost</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Locality</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Priority</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Number</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">CR Date</th>
          <th style="text-align:left; border-bottom:1px solid var(--border); padding:8px;">Status</th>
        </tr>
      </thead>
      <tbody id="rejectedTableBody"></tbody>
    </table>
  </div>
</div>


      </div>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; display: flex; justify-content: center; align-items: center;">
      <div style="background: white; border-radius: 12px; padding: 24px; max-width: 900px; max-height: 90%; overflow-y: auto; width: 95%;">
        <div class="row" style="justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h3 style="margin: 0;">Work Details Review</h3>
          <button id="closePreviewBtn" style="background: #ef4444; color: white; border: none; border-radius: 6px; padding: 8px 12px; cursor: pointer;">Close</button>
        </div>
        <div id="previewContent"></div>
        <!-- Committee/Council upload removed from preview: files should be attached when forwarded by admin -->
        <div class="field">
          <label>Commissioner Remarks</label>
          <textarea id="commissionerRemarks" placeholder="Enter your remarks here..." style="min-height: 100px;"></textarea>
        </div>
        <div id="verifySuccess" class="banner hidden" style="margin-top:12px;">Work verified successfully.</div>
        <div class="footer" style="margin-top: 20px; display: flex; gap: 12px; justify-content: flex-end;">
          <button id="saveRemarksBtn" class="btn" disabled>Verify & Save</button>
        </div>
      </div>
    </div>
  </div>

  <script src="dashboard.js"></script>
</body>
</html>